{% load i18n %}

<script>
    Vue.component("confirm-button", {
        props: ["text", "state"],
        name: "ConfirmButton",
        delimiters: ["[[", "]]"],
        template: `
        <button @click="$emit('startAction')" :class="{'disabled': state}" class="btn btn-md btn-primary">
            <span v-if="state" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            
            <span v-else>
                <i class="fa fa-check mr-3"></i>
                [[ text ]]
            </span>
        </button>
        `
    })

    Vue.component("form-component", {
        props: ["id", "position"],
        name: "Form",
        delimiters: ["[[", "]]"],
        template: `
        <form @submit.prevent="submitform" :id="id" method="POST">
            {% csrf_token %}

            <slot></slot>

            <div class="form-group">
                <input :value="position" type="hidden" name="position">
            </div>

            <div class="form-row">
                <div class="col-12 text-right">
                    <confirm-button @startAction="submitForm" :state="buttonState" text="{% trans 'Valider' %}" />
                </div>
            </div>
        </form>
        `,

        data() {
            return {
                buttonState: false
            }
        },

        methods: {
            submitForm: function () {
                this.buttonState = true
                this.$el.submit()
            }
        }
    })
</script>
